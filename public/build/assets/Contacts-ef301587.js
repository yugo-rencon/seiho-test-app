import{r as k,T,o as n,c as _,w as c,a as S,u as l,Z as U,b as e,d,i as h,t as o,h as $,j as y,v as j,k as F,e as m,g as M,n as D,F as E,f,O as V}from"./app-45ec2487.js";import{S as z}from"./SeihoTestLayout-2f906b66.js";const Z={class:"container mx-auto max-w-6xl px-5 py-8"},A={class:"mb-6 flex items-center justify-between gap-3"},G=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"問い合わせ管理"),e("p",{class:"mt-1 text-sm text-gray-500"},"問い合わせの確認・対応状況・管理メモを更新できます。")],-1),H={class:"mb-4 grid gap-2 sm:grid-cols-4"},J={class:"rounded-xl border border-gray-100 bg-white p-3"},K=e("p",{class:"text-xs text-gray-500"},"全件",-1),P={class:"text-xl font-bold text-gray-900"},Q={class:"rounded-xl border border-gray-100 bg-white p-3"},R=e("p",{class:"text-xs text-gray-500"},"未対応",-1),W={class:"text-xl font-bold text-gray-900"},X={class:"rounded-xl border border-gray-100 bg-white p-3"},Y=e("p",{class:"text-xs text-gray-500"},"対応中",-1),I={class:"text-xl font-bold text-blue-700"},ee={class:"rounded-xl border border-gray-100 bg-white p-3"},te=e("p",{class:"text-xs text-gray-500"},"対応済み",-1),se={class:"text-xl font-bold text-emerald-700"},oe=["onSubmit"],re=e("option",{value:"all"},"すべて",-1),ae=e("option",{value:"new"},"未対応",-1),de=e("option",{value:"in_progress"},"対応中",-1),le=e("option",{value:"done"},"対応済み",-1),ne=[re,ae,de,le],ie=e("button",{type:"submit",class:"whitespace-nowrap rounded-lg bg-purple-600 px-4 py-2 text-sm font-semibold text-white hover:bg-purple-500"}," 絞り込み ",-1),ue={class:"space-y-3"},ce={class:"flex flex-wrap items-center justify-between gap-2"},pe={class:"flex flex-wrap items-center gap-2"},xe={class:"text-xs text-gray-500"},ge={class:"rounded-full bg-gray-100 px-2 py-1 text-xs font-semibold text-gray-700"},be={class:"text-xs text-gray-500"},_e={class:"mt-3 space-y-1 text-sm"},he=e("span",{class:"text-gray-500"},"名前:",-1),ye=e("span",{class:"text-gray-500"},"メール:",-1),me=e("span",{class:"text-gray-500"},"対象ページ:",-1),fe=e("span",{class:"text-gray-500"},"会員:",-1),ve=e("span",{class:"text-gray-500"},"対応者:",-1),we=e("span",{class:"text-gray-500"},"対応日時:",-1),Ce={class:"mt-3 rounded-lg bg-gray-50 p-3 text-sm text-gray-800 whitespace-pre-wrap"},ke={class:"mt-3 flex flex-wrap gap-2"},Se=["onClick"],je=["onClick"],Ve=["onClick"],qe={class:"mt-3"},Ne=["onUpdate:modelValue"],Oe={class:"mt-2 flex justify-end"},Be=["disabled","onClick"],Le={key:0,class:"rounded-xl border border-gray-100 bg-white px-3 py-8 text-center text-sm text-gray-500"},Te={class:"mt-5 flex flex-wrap items-center gap-2 text-sm"},Fe={__name:"Contacts",props:{contacts:{type:Object,required:!0},filters:{type:Object,required:!0},statusCounts:{type:Object,required:!0}},setup(r){var v,w,C;const p=r,x=k(((v=p.filters)==null?void 0:v.q)??""),g=k(((w=p.filters)==null?void 0:w.status)??"all"),q=()=>{V.get(route("admin.contacts.index"),{q:x.value,status:g.value},{preserveState:!0,replace:!0})},b=(s,a)=>{V.post(route("admin.contacts.updateStatus",{contact:s}),{status:a},{preserveScroll:!0})},u=Object.fromEntries((((C=p.contacts)==null?void 0:C.data)??[]).map(s=>[s.id,T({admin_note:s.admin_note??""})])),N=s=>{const a=u[s];a&&a.post(route("admin.contacts.updateNote",{contact:s}),{preserveScroll:!0})},O=s=>s==="in_progress"?"対応中":s==="done"?"対応済み":"未対応",B=s=>s==="in_progress"?"bg-blue-50 text-blue-700":s==="done"?"bg-emerald-50 text-emerald-700":"bg-gray-100 text-gray-700",L=s=>s==="bug"?"不具合":s==="request"?"要望":s==="feedback"?"感想":"その他";return(s,a)=>(n(),_(z,{title:"問い合わせ管理"},{default:c(()=>[S(l(U),{title:"問い合わせ管理"}),e("div",Z,[e("div",A,[G,S(l(h),{href:s.route("admin.index"),class:"rounded-lg border border-gray-200 bg-white px-3 py-2 text-xs font-semibold text-gray-700 hover:bg-gray-50"},{default:c(()=>[d(" ユーザー管理へ戻る ")]),_:1},8,["href"])]),e("div",H,[e("div",J,[K,e("p",P,o(r.statusCounts.all),1)]),e("div",Q,[R,e("p",W,o(r.statusCounts.new),1)]),e("div",X,[Y,e("p",I,o(r.statusCounts.in_progress),1)]),e("div",ee,[te,e("p",se,o(r.statusCounts.done),1)])]),e("form",{onSubmit:$(q,["prevent"]),class:"mb-4 flex flex-col gap-2 rounded-xl border border-gray-100 bg-white p-3 sm:flex-row"},[y(e("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>x.value=t),type:"text",placeholder:"名前・メール・本文で検索",class:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-purple-300 focus:outline-none"},null,512),[[j,x.value]]),y(e("select",{"onUpdate:modelValue":a[1]||(a[1]=t=>g.value=t),class:"rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-purple-300 focus:outline-none"},ne,512),[[F,g.value]]),ie],40,oe),e("div",ue,[(n(!0),m(E,null,M(r.contacts.data,t=>(n(),m("div",{key:t.id,class:"rounded-xl border border-gray-100 bg-white p-4"},[e("div",ce,[e("div",pe,[e("span",xe,"#"+o(t.id),1),e("span",ge,o(L(t.category)),1),e("span",{class:D(["rounded-full px-2 py-1 text-xs font-semibold",B(t.status)])},o(O(t.status)),3)]),e("div",be," 受信: "+o(t.created_at||"-"),1)]),e("div",_e,[e("p",null,[he,d(" "+o(t.name||"-"),1)]),e("p",null,[ye,d(" "+o(t.email),1)]),e("p",null,[me,d(" "+o(t.page_url||"-"),1)]),e("p",null,[fe,d(" "+o(t.user_email||"未ログイン"),1)]),e("p",null,[ve,d(" "+o(t.handler_email||"-"),1)]),e("p",null,[we,d(" "+o(t.handled_at||"-"),1)])]),e("div",Ce,o(t.message),1),e("div",ke,[e("button",{type:"button",class:"rounded-lg border border-gray-200 px-3 py-1.5 text-xs font-semibold text-gray-700 hover:bg-gray-50",onClick:i=>b(t.id,"new")}," 未対応 ",8,Se),e("button",{type:"button",class:"rounded-lg border border-blue-200 px-3 py-1.5 text-xs font-semibold text-blue-700 hover:bg-blue-50",onClick:i=>b(t.id,"in_progress")}," 対応中 ",8,je),e("button",{type:"button",class:"rounded-lg border border-emerald-200 px-3 py-1.5 text-xs font-semibold text-emerald-700 hover:bg-emerald-50",onClick:i=>b(t.id,"done")}," 対応済み ",8,Ve)]),e("div",qe,[y(e("textarea",{"onUpdate:modelValue":i=>l(u)[t.id].admin_note=i,rows:"3",class:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-purple-300 focus:outline-none",placeholder:"管理者メモ（返信内容、対応履歴など）"},null,8,Ne),[[j,l(u)[t.id].admin_note]]),e("div",Oe,[e("button",{type:"button",class:"rounded-lg bg-purple-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-purple-500 disabled:opacity-60",disabled:l(u)[t.id].processing,onClick:i=>N(t.id)}," メモ保存 ",8,Be)])])]))),128)),r.contacts.data.length===0?(n(),m("div",Le," 該当する問い合わせはありません。 ")):f("",!0)]),e("div",Te,[r.contacts.prev_page_url?(n(),_(l(h),{key:0,href:r.contacts.prev_page_url,class:"rounded-lg border border-gray-200 bg-white px-3 py-1.5 text-gray-700 hover:bg-gray-50"},{default:c(()=>[d(" 前へ ")]),_:1},8,["href"])):f("",!0),r.contacts.next_page_url?(n(),_(l(h),{key:1,href:r.contacts.next_page_url,class:"rounded-lg border border-gray-200 bg-white px-3 py-1.5 text-gray-700 hover:bg-gray-50"},{default:c(()=>[d(" 次へ ")]),_:1},8,["href"])):f("",!0)])])]),_:1}))}};export{Fe as default};
